<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Resumen de datos climáticos</title>
   <style>
	    table {
      border-collapse: collapse;
      width: 100%;
    }

    /* th, td {
      border-bottom: 1px solid #999;
      padding: 8px;
      text-align: center;
    } */

    th {
      font-weight: bold;
      /* border-left: none; */
      /* border-right: none; */
    }

    td {
      /* border-left: none; */
      /* border-right: none; */
    }
    tr {
  border-bottom: 1px solid #ddd;
    }
  </style>

</head>
<body>
  <h2>Resumen desde datos.csv</h2>
  <table border="1">
    <thead>
      <tr>
        <th>Último registro</th>
        <th>T mín</th>
        <th>T máx</th>
        <th>T promedio</th>
        <th>HR mín</th>
        <th>HR máx</th>
        <th>HR promedio</th>
      </tr>
    </thead>
    <tbody id="tabla-resumen"></tbody>
  </table>

  <script>
    fetch('datos.csv')
      .then(response => response.text())
      .then(csv => {
        const lineas = csv.trim().split('\n').slice(1); // Ignora encabezado
        const fechas = [];
        const temperaturas = [];
        const humedades = [];

        lineas.forEach(linea => {
          const partes = linea.split(',');
          if (partes.length === 3) {
            const fecha = partes[0].trim();
            const temp = parseFloat(partes[1]);
            const hum = parseFloat(partes[2]);

            fechas.push(fecha);
            temperaturas.push(temp);
            humedades.push(hum);
          }
        });

        const ultimaFecha = fechas[fechas.length - 1];
        const tempMin = Math.min(...temperaturas);
        const tempMax = Math.max(...temperaturas);
        const tempProm = (temperaturas.reduce((a, b) => a + b, 0) / temperaturas.length).toFixed(2);

        const humMin = Math.min(...humedades);
        const humMax = Math.max(...humedades);
        const humProm = (humedades.reduce((a, b) => a + b, 0) / humedades.length).toFixed(2);

        const fila = `
          <tr>
            <td>${ultimaFecha}</td>
            <td>${tempMin} °C</td>
            <td>${tempMax} °C</td>
            <td>${tempProm} °C</td>
            <td>${humMin} %</td>
            <td>${humMax} %</td>
            <td>${humProm} %</td>
          </tr>
        `;

        document.getElementById('tabla-resumen').innerHTML = fila;
      })
      .catch(error => console.error('Error al cargar datos.csv:', error));
  </script>
</body>
</html>